<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: Focus</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: Focus</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>Focus<span class="signature">()</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>Class implementing the Focus protocol.</p>
<p>The primary purpose of this class is to implement the Focus protocol, with a
way to extend it from the outside, without requiring one to subclass.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="Focus"><span class="type-signature"></span>new Focus<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Create a new Focus object.</p>
<p>Ideally, there should only be one instance in a single application.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line27">line 27</a>
    </li></ul></dd>
    

    

    

    
</dl>


















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="addCommands"><span class="type-signature"></span>addCommands<span class="signature">(cmds)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Register new commands with the system.</p>
<p>Commands can either be functions, or objects with a <code>.focus</code> method. Both
<code>.focus</code> and the command-function take the same arguments: <code>self</code> (the
<code>Focus</code> instance running the handler; to have access to the <code>request</code>
method) and any number of arguments, which are supposed to be the
arguments of the command the handler is executing.</p>
<p>Handlers <strong>must</strong> return promises, the result of their commands,
post-processed in whatever way is most practical for the command in
question.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>cmds</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last"><p>The command functions / objects to register, as
name-value pairs.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line260">line 260</a>
    </li></ul></dd>
    

    

    

    
</dl>


















        
            

    

    
    <h4 class="name" id="close"><span class="type-signature"></span>close<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Close the currently opened device, if any.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line144">line 144</a>
    </li></ul></dd>
    

    

    

    
</dl>


















        
            

    

    
    <h4 class="name" id="command"><span class="type-signature">(async) </span>command<span class="signature">(cmd, &hellip;args)</span><span class="type-signature"> &rarr; {Promise.&lt;object>}</span></h4>
    

    



<div class="description">
    <p>Send a high-level command, and return a processed response.</p>
<p>Commands registered with <code>addCommands</code> can be called by using this
method. If the command to be sent is recognised, it will send the command
through the registered handler. If it isn't known, falls back to
<code>request()</code>.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>cmd</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>the command to send.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>args</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>optional arguments for the command.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line234">line 234</a>
    </li></ul></dd>
    

    

    

    
</dl>











<h5>Throws:</h5>

        

    <div class="param-desc">
    
        <p>Will throw an error if the instance isn't connected to the
keyboard yet.</p>
    
    </div>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The processed response.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;object></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="find"><span class="type-signature">(async) </span>find<span class="signature">(&hellip;devices)</span><span class="type-signature"> &rarr; {Promise.&lt;Array>}</span></h4>
    

    



<div class="description">
    <p>Find devices that match certain criteria.</p>
<p>Given a list of supported devices, look through the system and find
matching ones. Each argument must be an object with an <code>usb</code> property,
which in turn must have <code>productId</code> and <code>vendorId</code> properties. The method
will match these with USB devices on the system, and return a list of
matches.</p>
<p>For example, a <code>device</code> descriptor may look like this:</p>
<pre class="prettyprint source lang-json"><code>const Model01 = {
  usb: {
    vendorId: 0x1209,
    productId: 0x2301
  },
  keyboard: {
    rows: 4,
    columns: 16
  }
}</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>devices</code></td>
            

            <td class="type">
            
                
<span class="param-type">DEVICE</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>List of supported, or sought-after devices.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line75">line 75</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A list of port descriptors for matching
devices.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="open"><span class="type-signature">(async) </span>open<span class="signature">(opts)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Open a device. This is a <strong>required</strong> step before doing any of the other
operations (save <code>find</code>).</p>
<p>The argument can either be a <code>string</code>, a <code>SerialPort</code> object, or a device
descriptor (see <code>find</code> above).</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>opts</code></td>
            

            <td class="type">
            
                
<span class="param-type">OPTIONS</span>


            
            </td>

            

            

            <td class="description last"><p>Either a path to the device, or a <code>SerialPort</code>
object, or a device descriptor.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line103">line 103</a>
    </li></ul></dd>
    

    

    

    
</dl>


















        
            

    

    
    <h4 class="name" id="probe"><span class="type-signature"></span>probe<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Boolean>}</span></h4>
    

    



<div class="description">
    <p>Probe for Focus support on an opened device.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line157">line 157</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>, signaling whether the probe was successful
or not.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Boolean></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="request"><span class="type-signature">(async) </span>request<span class="signature">(cmd, &hellip;args)</span><span class="type-signature"> &rarr; {Promise.&lt;String>}</span></h4>
    

    



<div class="description">
    <p>Send a low-level request, and return the (mostly) unprocessed response.</p>
<p>This method is close to the wire, as all it does, is format its
arguments, send the command, and return the results. The only processing
done on the results is making sure we don't read too much.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>cmd</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>the command to send.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>args</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>optional arguments for the command.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="chrysalis-focus.js.html">chrysalis-focus.js</a>, <a href="chrysalis-focus.js.html#line198">line 198</a>
    </li></ul></dd>
    

    

    

    
</dl>











<h5>Throws:</h5>

        

    <div class="param-desc">
    
        <p>Will throw an error if the instance isn't connected to the
keyboard yet.</p>
    
    </div>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The unprocessed response.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;String></span>


    </dd>
</dl>

    





        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Focus.html">Focus</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Dec 02 2018 09:34:24 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>